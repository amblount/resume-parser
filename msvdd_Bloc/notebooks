{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import io\n",
    "import itertools\n",
    "import json\n",
    "import pathlib\n",
    "import requests\n",
    "import en_core_web_md\n",
    "import os\n",
    "import re\n",
    "import missingno as msno\n",
    "import spacy\n",
    "import textacy\n",
    "from html.parser import HTMLParser\n",
    "import sys\n",
    "sys.path.insert(0, '/Users/nissani/Desktop/msvdd_Bloc/msvdd_bloc')\n",
    "import msvdd_bloc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The watermark extension is already loaded. To reload it, use:\n",
      "  %reload_ext watermark\n"
     ]
    }
   ],
   "source": [
    "%load_ext watermark"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "numpy          1.17.2\n",
      "json           2.0.9\n",
      "textacy        0.9.1\n",
      "re             2.2.1\n",
      "pandas         0.25.1\n",
      "matplotlib     3.1.1\n",
      "seaborn        0.9.0\n",
      "missingno      0.4.2\n",
      "spacy          2.1.8\n",
      "requests       2.22.0\n",
      "en_core_web_md 2.1.0\n",
      "CPython 3.7.0\n",
      "IPython 7.8.0\n"
     ]
    }
   ],
   "source": [
    "%watermark -v -iv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dir = pathlib.Path(\"/Users/nissani/Desktop/msvdd_Bloc/data/postings\")\n",
    "role_queries = [\n",
    "    \"web developer\",\n",
    "    \"front-end developer\",\n",
    "    \"back-end developer\",\n",
    "    \"full-stack developer\",\n",
    "    \"python\",\n",
    "    \"data scientist\",\n",
    "    \"data engineer\",\n",
    "]\n",
    "category_queries = [\"Engineering\", \"Data Science\"]\n",
    "locations = [\n",
    "    \"New York, NY\",\n",
    "    \"Chicago, IL\",\n",
    "    \"San Francisco, CA\",\n",
    "    \"San Jose, CA\",\n",
    "    \"Los Angeles, CA\",\n",
    "    \"Seattle, WA\",\n",
    "    \"Austin, TX\",\n",
    "    \"Washington, DC\",\n",
    "    \"Baltimore, MD\",\n",
    "    \"Boston, MA\",\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "def load_dataset(filepath, **kwargs):\n",
    "    \"\"\"\n",
    "    Args:\n",
    "        filepath (str)\n",
    "        kwargs: Additional params passed as-is\n",
    "            into :func:`pd.read_json()`, useful for setting\n",
    "            dataset-specific dtypes, etc.\n",
    "    \n",
    "    Returns:\n",
    "        :class:`pd.DataFrame`\n",
    "    \"\"\"\n",
    "    # almost too easy ;)\n",
    "    return pd.read_json(path_or_buf=filepath, **kwargs)\n",
    "\n",
    "\n",
    "def inspect_dataset(dataset):\n",
    "    \"\"\"\n",
    "    Args:\n",
    "        dataset (:class:`pd.DataFrame`)\n",
    "    \"\"\"\n",
    "    print(\"shape:\", dataset.shape)\n",
    "    print(\"columns:\", \", \".join(dataset.columns))\n",
    "    return dataset.describe(include=\"all\")\n",
    "\n",
    "\n",
    "class _HTMLParser(HTMLParser):\n",
    "    \n",
    "    def __init__(self):\n",
    "        super().__init__()\n",
    "        self._texts = []\n",
    "    \n",
    "    def handle_data(self, data):\n",
    "        self._texts.append(data)\n",
    "        \n",
    "    def get_text(self):\n",
    "        return \"\".join(self._texts)\n",
    "\n",
    "\n",
    "def extract_text_from_html(html):\n",
    "    \"\"\"\n",
    "    Basic, stdlib-only function for extracting text data from HML.\n",
    "    \n",
    "    Args:\n",
    "        html (str)\n",
    "        \n",
    "    Returns:\n",
    "        str\n",
    "    \"\"\"\n",
    "    parser = _HTMLParser()\n",
    "    parser.feed(html)\n",
    "    parser.close()\n",
    "    return parser.get_text().strip()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [],
   "source": [
    "github_jobs = load_dataset('/Users/nissani/Desktop/msvdd_Bloc/data/postings/github_jobs.json')\n",
    "indeed_jobs = load_dataset('/Users/nissani/Desktop/msvdd_Bloc/data/postings/indeed_jobs.json')\n",
    "muse_jobs = load_dataset('/Users/nissani/Desktop/msvdd_Bloc/data/postings/themuse_jobs.json')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'<p>Simon &amp; Schuster is seeking a Lead Software Engineer to join a rapidly growing team focused on impacting the world of publishing through research and innovation. Working with a team of data scientists, data engineers, designers, and domain experts, you will be involved in rapidly prototyping, developing, and deploying the platforms that put insights and information into the hands of decision-makers.</p>\\n<p>From databases to serverless applications, you will be designing, deploying , and managing the systems that connect our real-world data to the books and authors that inform and entertain our world. As a Full Stack (Engineer|Developer) you will engage with engineers and domain experts across the organization, collaborating to design and deploy innovative new products and services. From inception to production, you will onboard, integrate and deploy an array of cutting-edge tools and technologies to seamlessly deliver our solutions.</p>\\n<p>Publishing experience is not required. Instead we are seeking teammates with curiosity, problem-solving skills, and a thirst for knowledge.</p>\\n<p>Responsibilities:</p>\\n<p>●     Scale team success from prototype to production.\\n●     Own the software engineering aspects of our data services and applications.\\n●     Design, build, test, and deploy solutions serving the entire organization.\\n●     Be the “go to” engineer for our products and services.\\n●     Tailor and drive the creation and adoption of best practices for software engineering for our team and peer engineering teams across the organization.\\n●     Work with users, designers, developers, and analysts to ensure requirements-driven engineering in all we do.\\n●     Ensure high availability and security are maintained in the products and services delivered by our team.</p>\\n<p>Qualifications:\\n●     5+ years experience in web application development and managing deployments\\n●      Experience with full-stack development: Front-end, web servers, databases and storage.\\n●      Deep understanding of modern software development practices (CI/CD, Continuous Monitoring, Testing, Documentation)\\n●     Experience in production commercial with architecting and managing cloud deployments (GCP, AWS, Azure, etc.)\\n●     Proficiency with Linux, SQL, Python, and Javascript required\\n●     Solid background working with large-scale and fast-moving data technologies (Streaming, NoSQL, Object-stores, etc.)\\n●     Familiarity with common build systems, Github/Gitlab, Confluence, JIRA\\n●     Ability to work effectively in teams of technical and non-technical people.\\n●     Ability to work independently and effectively\\n●     Desire to research and communicate requirements and solutions.</p>\\n'"
      ]
     },
     "execution_count": 80,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "github_jobs['description'][0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove from github: url, id, company_url, company_log\n",
    "\n",
    "Keep from github: type, created_at, company, location, title, description, how_to_apply"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['id', 'type', 'url', 'created_at', 'company', 'company_url', 'location',\n",
      "       'title', 'description', 'how_to_apply', 'company_logo'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>created_at</th>\n",
       "      <th>company</th>\n",
       "      <th>location</th>\n",
       "      <th>title</th>\n",
       "      <th>description</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2019-09-11 18:59:59+00:00</td>\n",
       "      <td>Simon &amp; Schuster</td>\n",
       "      <td>New York, NY</td>\n",
       "      <td>Lead Software Engineer</td>\n",
       "      <td>&lt;p&gt;Simon &amp;amp; Schuster is seeking a Lead Soft...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2019-09-09 15:29:25+00:00</td>\n",
       "      <td>Noe &amp; Associates</td>\n",
       "      <td>New York, NY</td>\n",
       "      <td>Web Developer</td>\n",
       "      <td>&lt;p&gt;A leading international branding and design...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2018-11-19 19:40:01+00:00</td>\n",
       "      <td>Prosek Partners</td>\n",
       "      <td>Fairfield, CT</td>\n",
       "      <td>Front End Developer</td>\n",
       "      <td>&lt;p&gt;Background&lt;/p&gt;\\n&lt;p&gt;Prosek Partners, one of ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2018-11-19 15:44:44+00:00</td>\n",
       "      <td>Aon Cyber Solutions</td>\n",
       "      <td>NY or LA</td>\n",
       "      <td>Cybersecurity Firm Seeks Senior Developer</td>\n",
       "      <td>&lt;p&gt;Aon Cyber Solutions is looking for a Senior...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2018-11-14 22:16:02+00:00</td>\n",
       "      <td>The Atlantic</td>\n",
       "      <td>Washington, DC &amp; New York, NY</td>\n",
       "      <td>Lead Front End Developer</td>\n",
       "      <td>&lt;p&gt;The Atlantic is a digital-first media compa...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 created_at              company  \\\n",
       "0 2019-09-11 18:59:59+00:00    Simon & Schuster    \n",
       "1 2019-09-09 15:29:25+00:00     Noe & Associates   \n",
       "2 2018-11-19 19:40:01+00:00      Prosek Partners   \n",
       "3 2018-11-19 15:44:44+00:00  Aon Cyber Solutions   \n",
       "4 2018-11-14 22:16:02+00:00         The Atlantic   \n",
       "\n",
       "                        location                                      title  \\\n",
       "0                   New York, NY                     Lead Software Engineer   \n",
       "1                   New York, NY                              Web Developer   \n",
       "2                  Fairfield, CT                        Front End Developer   \n",
       "3                       NY or LA  Cybersecurity Firm Seeks Senior Developer   \n",
       "4  Washington, DC & New York, NY                   Lead Front End Developer   \n",
       "\n",
       "                                         description  \n",
       "0  <p>Simon &amp; Schuster is seeking a Lead Soft...  \n",
       "1  <p>A leading international branding and design...  \n",
       "2  <p>Background</p>\\n<p>Prosek Partners, one of ...  \n",
       "3  <p>Aon Cyber Solutions is looking for a Senior...  \n",
       "4  <p>The Atlantic is a digital-first media compa...  "
      ]
     },
     "execution_count": 81,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(github_jobs.columns)\n",
    "github_standard = github_jobs.drop(['url', 'id', 'company_url', 'company_logo', 'how_to_apply', 'type'], axis=1)\n",
    "github_standard.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove from Indeed: city, state, country, source, url, onmousedown, latitude, longitude, jobkey, sponsored, indeedApply, formattedLocation, stations, recommendations\n",
    "\n",
    "Keep from Indeed: jobtitle, company, snippet, formattedLocationFull, formattedRelativeTime, date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['jobtitle', 'company', 'city', 'state', 'country', 'language',\n",
      "       'formattedLocation', 'source', 'date', 'snippet', 'url', 'onmousedown',\n",
      "       'latitude', 'longitude', 'jobkey', 'sponsored', 'expired',\n",
      "       'indeedApply', 'formattedLocationFull', 'formattedRelativeTime',\n",
      "       'stations', 'recommendations'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>jobtitle</th>\n",
       "      <th>company</th>\n",
       "      <th>date</th>\n",
       "      <th>snippet</th>\n",
       "      <th>formattedLocationFull</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Junior Developer</td>\n",
       "      <td>Muratek</td>\n",
       "      <td>2019-09-20 16:25:56+00:00</td>\n",
       "      <td>Develop and maintain code, image assets and co...</td>\n",
       "      <td>New York, NY 10038</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Front End Developer</td>\n",
       "      <td>Halo Media</td>\n",
       "      <td>2019-09-11 00:50:51+00:00</td>\n",
       "      <td>Our staff works on accounts by some of the wor...</td>\n",
       "      <td>New York, NY 10001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Mid-Level Fullstack Javascript Engineer</td>\n",
       "      <td>Mantl</td>\n",
       "      <td>2019-09-20 22:53:35+00:00</td>\n",
       "      <td>Our mission is to use technology to level the ...</td>\n",
       "      <td>New York, NY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Entry Level Software Developer</td>\n",
       "      <td>CloudServiceTek</td>\n",
       "      <td>2019-09-27 23:37:05+00:00</td>\n",
       "      <td>Sound expertise in defining technical architec...</td>\n",
       "      <td>New York, NY 10020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Junior Software Developer Intern</td>\n",
       "      <td>Live Building Systems</td>\n",
       "      <td>2019-09-25 15:08:35+00:00</td>\n",
       "      <td>Completed or working on Bachelor’s Degree in C...</td>\n",
       "      <td>New York, NY 10010</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  jobtitle                company  \\\n",
       "0                         Junior Developer                Muratek   \n",
       "1                      Front End Developer             Halo Media   \n",
       "2  Mid-Level Fullstack Javascript Engineer                  Mantl   \n",
       "3           Entry Level Software Developer        CloudServiceTek   \n",
       "4         Junior Software Developer Intern  Live Building Systems   \n",
       "\n",
       "                       date  \\\n",
       "0 2019-09-20 16:25:56+00:00   \n",
       "1 2019-09-11 00:50:51+00:00   \n",
       "2 2019-09-20 22:53:35+00:00   \n",
       "3 2019-09-27 23:37:05+00:00   \n",
       "4 2019-09-25 15:08:35+00:00   \n",
       "\n",
       "                                             snippet formattedLocationFull  \n",
       "0  Develop and maintain code, image assets and co...    New York, NY 10038  \n",
       "1  Our staff works on accounts by some of the wor...    New York, NY 10001  \n",
       "2  Our mission is to use technology to level the ...          New York, NY  \n",
       "3  Sound expertise in defining technical architec...    New York, NY 10020  \n",
       "4  Completed or working on Bachelor’s Degree in C...    New York, NY 10010  "
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(indeed_jobs.columns)\n",
    "indeed_standard = indeed_jobs.drop(['city', 'state', 'country', 'source', 'url', 'onmousedown', 'latitude', 'longitude', \n",
    "                                'jobkey', 'sponsored', 'indeedApply', 'formattedLocation', 'stations', 'recommendations',\n",
    "                                'language', 'expired', 'formattedRelativeTime'], axis = 1)\n",
    "indeed_standard.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove from Muse: type, short_name, model_type, id, tags, refs\n",
    "\n",
    "Keep from Muse: contents, name, publication_date, locations, categories, levels, company(name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['contents', 'name', 'type', 'publication_date', 'short_name',\n",
      "       'model_type', 'id', 'locations', 'categories', 'levels', 'tags', 'refs',\n",
      "       'company'],\n",
      "      dtype='object')\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>contents</th>\n",
       "      <th>name</th>\n",
       "      <th>publication_date</th>\n",
       "      <th>locations</th>\n",
       "      <th>company</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>&lt;p&gt;&lt;span&gt;Language diverse monorepo seeks exper...</td>\n",
       "      <td>Lead Build Engineer</td>\n",
       "      <td>2019-08-19T14:30:34.532418Z</td>\n",
       "      <td>[{'name': 'New York, NY'}]</td>\n",
       "      <td>{'id': 11755, 'short_name': 'beeswax', 'name':...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>&lt;p&gt;&lt;span&gt;In a Site Reliability Engineering rol...</td>\n",
       "      <td>Site Reliability Engineer</td>\n",
       "      <td>2019-08-19T14:30:34.597968Z</td>\n",
       "      <td>[{'name': 'New York, NY'}]</td>\n",
       "      <td>{'id': 11755, 'short_name': 'beeswax', 'name':...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>&lt;div&gt;&lt;span&gt;Etsy is looking for an experienced ...</td>\n",
       "      <td>Core Platform Engineering Manager</td>\n",
       "      <td>2019-07-23T18:38:29.951266Z</td>\n",
       "      <td>[{'name': 'New York, NY'}]</td>\n",
       "      <td>{'id': 1222, 'short_name': 'etsy', 'name': 'Et...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>&lt;h3&gt;The company:&lt;/h3&gt;\\n\\n&lt;p&gt;We're on a mission...</td>\n",
       "      <td>Engineering Team Lead - Cloud Platforms</td>\n",
       "      <td>2019-08-30T17:06:09.667397Z</td>\n",
       "      <td>[{'name': 'New York, NY'}]</td>\n",
       "      <td>{'id': 756, 'short_name': 'datadog', 'name': '...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>&lt;p&gt;&lt;strong&gt;About This Position &lt;/strong&gt;&lt;/p&gt;\\n...</td>\n",
       "      <td>Senior Software Engineer</td>\n",
       "      <td>2019-06-19T07:56:17.584313Z</td>\n",
       "      <td>[{'name': 'New York, NY'}]</td>\n",
       "      <td>{'id': 1507, 'short_name': 'ellevest', 'name':...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                            contents  \\\n",
       "0  <p><span>Language diverse monorepo seeks exper...   \n",
       "1  <p><span>In a Site Reliability Engineering rol...   \n",
       "2  <div><span>Etsy is looking for an experienced ...   \n",
       "3  <h3>The company:</h3>\\n\\n<p>We're on a mission...   \n",
       "4  <p><strong>About This Position </strong></p>\\n...   \n",
       "\n",
       "                                      name             publication_date  \\\n",
       "0                     Lead Build Engineer   2019-08-19T14:30:34.532418Z   \n",
       "1                Site Reliability Engineer  2019-08-19T14:30:34.597968Z   \n",
       "2        Core Platform Engineering Manager  2019-07-23T18:38:29.951266Z   \n",
       "3  Engineering Team Lead - Cloud Platforms  2019-08-30T17:06:09.667397Z   \n",
       "4                 Senior Software Engineer  2019-06-19T07:56:17.584313Z   \n",
       "\n",
       "                    locations  \\\n",
       "0  [{'name': 'New York, NY'}]   \n",
       "1  [{'name': 'New York, NY'}]   \n",
       "2  [{'name': 'New York, NY'}]   \n",
       "3  [{'name': 'New York, NY'}]   \n",
       "4  [{'name': 'New York, NY'}]   \n",
       "\n",
       "                                             company  \n",
       "0  {'id': 11755, 'short_name': 'beeswax', 'name':...  \n",
       "1  {'id': 11755, 'short_name': 'beeswax', 'name':...  \n",
       "2  {'id': 1222, 'short_name': 'etsy', 'name': 'Et...  \n",
       "3  {'id': 756, 'short_name': 'datadog', 'name': '...  \n",
       "4  {'id': 1507, 'short_name': 'ellevest', 'name':...  "
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(muse_jobs.columns)\n",
    "muse_standard = muse_jobs.drop(['type', 'short_name', 'model_type', 'id', 'tags', 'refs', 'levels', 'categories'], axis = 1)\n",
    "muse_standard.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [],
   "source": [
    "muse_standard.columns = ['description', 'job_title', 'date_posted', 'location', 'company']\n",
    "github_standard.columns = ['date_posted', 'company', 'location', 'job_title', 'description']\n",
    "indeed_standard.columns = ['job_title', 'company', 'date_posted', 'description', 'location']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [],
   "source": [
    "def reformat(dataframe):\n",
    "    list_of_titles = ['job_title', 'company', 'location', 'description', 'date_posted']\n",
    "    data = []\n",
    "    for el in list_of_titles:\n",
    "        data.append(dataframe[el])\n",
    "        \n",
    "    new_dataframe = pd.concat(data, axis = 1)\n",
    "    \n",
    "    new_dataframe.columns = list_of_titles\n",
    "    \n",
    "    return new_dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [],
   "source": [
    "muse = reformat(muse_standard)\n",
    "github = reformat(github_standard)\n",
    "indeed = reformat(indeed_standard)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [],
   "source": [
    "all_jobs = pd.concat([github, muse, indeed])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [],
   "source": [
    "all_jobs.index = [i for i in range(len(all_jobs))]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>job_title</th>\n",
       "      <th>company</th>\n",
       "      <th>location</th>\n",
       "      <th>description</th>\n",
       "      <th>date_posted</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Lead Software Engineer</td>\n",
       "      <td>Simon &amp; Schuster</td>\n",
       "      <td>New York, NY</td>\n",
       "      <td>&lt;p&gt;Simon &amp;amp; Schuster is seeking a Lead Soft...</td>\n",
       "      <td>2019-09-11 18:59:59+00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Web Developer</td>\n",
       "      <td>Noe &amp; Associates</td>\n",
       "      <td>New York, NY</td>\n",
       "      <td>&lt;p&gt;A leading international branding and design...</td>\n",
       "      <td>2019-09-09 15:29:25+00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Front End Developer</td>\n",
       "      <td>Prosek Partners</td>\n",
       "      <td>Fairfield, CT</td>\n",
       "      <td>&lt;p&gt;Background&lt;/p&gt;\\n&lt;p&gt;Prosek Partners, one of ...</td>\n",
       "      <td>2018-11-19 19:40:01+00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Cybersecurity Firm Seeks Senior Developer</td>\n",
       "      <td>Aon Cyber Solutions</td>\n",
       "      <td>NY or LA</td>\n",
       "      <td>&lt;p&gt;Aon Cyber Solutions is looking for a Senior...</td>\n",
       "      <td>2018-11-19 15:44:44+00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Lead Front End Developer</td>\n",
       "      <td>The Atlantic</td>\n",
       "      <td>Washington, DC &amp; New York, NY</td>\n",
       "      <td>&lt;p&gt;The Atlantic is a digital-first media compa...</td>\n",
       "      <td>2018-11-14 22:16:02+00:00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   job_title              company  \\\n",
       "0                     Lead Software Engineer    Simon & Schuster    \n",
       "1                              Web Developer     Noe & Associates   \n",
       "2                        Front End Developer      Prosek Partners   \n",
       "3  Cybersecurity Firm Seeks Senior Developer  Aon Cyber Solutions   \n",
       "4                   Lead Front End Developer         The Atlantic   \n",
       "\n",
       "                        location  \\\n",
       "0                   New York, NY   \n",
       "1                   New York, NY   \n",
       "2                  Fairfield, CT   \n",
       "3                       NY or LA   \n",
       "4  Washington, DC & New York, NY   \n",
       "\n",
       "                                         description  \\\n",
       "0  <p>Simon &amp; Schuster is seeking a Lead Soft...   \n",
       "1  <p>A leading international branding and design...   \n",
       "2  <p>Background</p>\\n<p>Prosek Partners, one of ...   \n",
       "3  <p>Aon Cyber Solutions is looking for a Senior...   \n",
       "4  <p>The Atlantic is a digital-first media compa...   \n",
       "\n",
       "                 date_posted  \n",
       "0  2019-09-11 18:59:59+00:00  \n",
       "1  2019-09-09 15:29:25+00:00  \n",
       "2  2018-11-19 19:40:01+00:00  \n",
       "3  2018-11-19 15:44:44+00:00  \n",
       "4  2018-11-14 22:16:02+00:00  "
      ]
     },
     "execution_count": 104,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_jobs.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
